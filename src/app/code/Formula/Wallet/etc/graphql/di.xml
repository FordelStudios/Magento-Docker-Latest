<?xml version="1.0"?>
<!--
/**
 * GraphQL area DI configuration
 *
 * Registers wallet protection plugins for the GraphQL area to prevent
 * customers from manipulating their wallet balance via GraphQL mutations.
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">

    <!-- Plugin to prevent customers from updating their own wallet balance via GraphQL -->
    <type name="Magento\Customer\Api\CustomerRepositoryInterface">
        <plugin name="formula_wallet_prevent_customer_balance_update_graphql"
                type="Formula\Wallet\Plugin\CustomerRepositoryPlugin"
                sortOrder="10" />
    </type>

    <!-- Plugin to prevent cart extension attribute manipulation via GraphQL -->
    <type name="Magento\Quote\Api\CartRepositoryInterface">
        <plugin name="formula_wallet_cart_save_protection_graphql"
                type="Formula\Wallet\Plugin\CartRepositorySavePlugin"
                sortOrder="1" />
    </type>

</config>
